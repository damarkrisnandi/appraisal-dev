import{a as E,c as Ce}from"./chunk-ZZBE6MK7.js";import{b as oe,c as ie}from"./chunk-FO6KVJXE.js";import{K as v,h as x,i as F,j as be,m as Y,n as Z,y as ee}from"./chunk-RAQWMTHX.js";import{b as X,f as te}from"./chunk-R7WHARF6.js";import{p as T}from"./chunk-W6BPNARK.js";import"./chunk-4YRY4IP2.js";import"./chunk-EMVC5IJA.js";import"./chunk-AIVTLASU.js";import"./chunk-AUJU2NY4.js";import{a as je}from"./chunk-OQKDZ6KP.js";import{b as Q,e as A,f as I,g as _e,h as L,l as R,m as k,o as he,r as pe}from"./chunk-3RUIS27I.js";import{b as de,m as fe}from"./chunk-NXN4P4DR.js";import{a as Se}from"./chunk-QASMVVIP.js";import{a as ge}from"./chunk-BUA7TEAX.js";import{qa as ue,ua as K}from"./chunk-22342MAH.js";import{$b as P,Ab as G,Bb as n,Cb as r,Db as d,Hb as w,Ib as f,Jb as m,Qc as q,Sb as W,Tb as l,Ub as y,Vb as z,Wc as J,Ya as a,Z as O,_b as ce,ac as M,ca as j,da as g,fb as p,ha as C,kc as U,mc as H,nc as D,ob as S,ra as _,rb as c,sa as h,wb as $,zb as B}from"./chunk-QSF35MWG.js";var ne=class{targetId;mappingProjectId};var re=class o{sendProjectAssessmentStore=g(b);ref=g(oe);visibleViewLookup=!1;formGroupSend=new _e({selectedData:new L(null)});batal(){this.ref.close()}pilih(){this.sendProjectAssessmentStore.doSend(this.formGroupSend.get("selectedData")?.value)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-send-project-assessment-send-lookup"]],standalone:!0,features:[P],decls:9,vars:2,consts:[[1,"grid","grid-cols-12","gap-2"],[1,"col-span-1","content-center"],[1,"col-span-8",3,"formGroup"],["formControlName","selectedData","placeholder","Nama Pm/ Nama TL","appendTo","body",1,"w-full",3,"options"],[1,"col-span-1"],["label","Send",3,"onClick"],["label","Batal","severity","danger",3,"onClick"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1),l(2,"Send To:"),r(),n(3,"div",2),d(4,"p-select",3),r(),n(5,"div",4)(6,"p-button",5),f("onClick",function(){return i.pilih()}),r()(),n(7,"div",4)(8,"p-button",6),f("onClick",function(){return i.batal()}),r()()()),e&2&&(a(3),c("formGroup",i.formGroupSend),a(),c("options",i.sendProjectAssessmentStore.$optionPmTlList()))},dependencies:[v,A,I,F,T,R,k]})};var Le=pe.APPRAISAL_API_URL+"/project-assessment",De=pe.APPRAISAL_API_URL+"/project",ae=class o{constructor(t){this.http=t}findByCriteriaPaginated(t,e){let i={wrapper:t,pagingInfo:e};return this.http.post(Le+"/findByCriteriaPaginated",i)}send(t){return this.http.post(Le+"/send",t)}getPMAndTL(t){return this.http.get(De+t+"/getPMAndTL")}static \u0275fac=function(e){return new(e||o)(j(de))};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};var b=class o{constructor(t,e,i,s,u,V){this.spinnerService=t;this.dialogService=e;this.messageService=i;this.sendProjectAssessmentsService=s;this.projectService=u;this.router=V;this.setSpinner(),this.setSearchCategoryProject(),this.setSearchCategoryMember()}fb=g(he);state={$dataListProject:p([]),$dataListMember:p([]),$dataLoading:p(!1),$selectedData:p(null),$loading:p(!1),$pagingInfo:p(new je),$projectWrapper:p(null),$totalRowCount:p(0),$searchOptions:p([]),$searchOptionsEmployee:p([]),$optionPmTlList:p([]),$formMode:p("projectList")};$dataListProject=this.state.$dataListProject.asReadonly();$dataListMember=this.state.$dataListMember.asReadonly();$dataLoading=this.state.$dataLoading.asReadonly();$pagingInfo=this.state.$pagingInfo.asReadonly();$totalRowCount=this.state.$totalRowCount.asReadonly();$colsProject=p([{field:"projectName",header:"Project Name"},{field:"projectManager",header:"Project Manager"},{field:"teamLeader",header:"Team Leader"},{field:"startDate",header:"Start Date",format:"date"},{field:"endDate",header:"End Date",format:"date"},{field:"totalMember",header:"Total Member",format:"center"}]).asReadonly();$colsMember=p([{field:"employeeId",header:"Employee Id"},{field:"employeeName",header:"Name"},{field:"projectRoleName",header:"Position"},{field:"levelName",header:"Level"},{field:"startDate",header:"Start Date",format:"date"},{field:"endDate",header:"End Date",format:"date"},{field:"projectId",header:"No Template"}]).asReadonly();$projectWrapper=this.state.$projectWrapper.asReadonly();$selectData=this.state.$selectedData.asReadonly();$optionsCategory=this.state.$searchOptions.asReadonly();$optionsCategoryEmployeeList=this.state.$searchOptionsEmployee.asReadonly();$searchForm=p(this.fb.group({category:new L({value:null,disabled:!1}),searchText:new L({value:"",disabled:!1}),startDate:new L({value:null,disabled:!1}),endDate:new L({value:null,disabled:!1})}));$optionPmTlList=this.state.$optionPmTlList.asReadonly();$formMode=this.state.$formMode.asReadonly();ref;setSpinner(){Se(this.state.$loading).subscribe(t=>t?this.spinnerService.show():this.spinnerService.hide())}onLazyLoadProject(t){let e=this.state.$pagingInfo();e.currentPage=Math.floor(t.first/t.rows)+1,e.pageSize=t.rows,this.state.$pagingInfo.set(e),this.populateListProject()}populateListProject(t){this.state.$dataLoading.set(!0),console.log("MODE ",this.state.$formMode());let e=t||new E;this.state.$dataListProject.set([]),this.findByCriteriaPaginatedProject(e)}findByCriteriaPaginatedProject(t){this.projectService.findByCriteriaPaginated(t,this.state.$pagingInfo()).subscribe(e=>{e.status?(this.state.$pagingInfo.set(e.object.pagingInfo),this.state.$totalRowCount.set(e.object.totalRowCount),this.state.$dataListProject.set(e.object.dataList)):console.error("Failed to fetch project dataList."),this.state.$dataLoading.set(!1)},e=>{this.state.$dataLoading.set(!1),console.error("Error fetching project dataList:",e)})}findUnsentByCriteriaPaginatedProject(t){this.projectService.findUnsentByCriteriaPaginated(t,this.state.$pagingInfo()).subscribe(e=>{e.status?(this.state.$pagingInfo.set(e.object.pagingInfo),this.state.$totalRowCount.set(e.object.totalRowCount),this.state.$dataListProject.set(e.object.dataList)):console.error("Failed to fetch project dataList."),this.state.$dataLoading.set(!1)},e=>{this.state.$dataLoading.set(!1),console.error("Error fetching project dataList:",e)})}onLazyLoadMember(t){let e=this.state.$pagingInfo();e.currentPage=Math.floor(t.first/t.rows)+1,e.pageSize=t.rows,this.state.$pagingInfo.set(e),this.populateListMember()}populateListMember(t){this.state.$dataLoading.set(!0),console.log("MODE 2 ",this.state.$formMode());let e=t||new E;e.projectId=this.state.$selectedData()?.id,this.state.$dataListMember.set([]),this.findByCriteriaPaginatedMember(e)}findByCriteriaPaginatedMember(t){this.projectService.findUnsentByCriteriaPaginated(t,this.state.$pagingInfo()).subscribe(e=>{e.status?(this.state.$pagingInfo.set(e.object.pagingInfo),this.state.$totalRowCount.set(e.object.totalRowCount),this.state.$dataListMember.set(e.object.dataList)):console.error("Failed to fetch project dataList."),this.state.$dataLoading.set(!1)},e=>{this.state.$dataLoading.set(!1),console.error("Error fetching project dataList:",e)})}setSearchCategoryProject(){this.state.$searchOptions.set([{label:"Semua",value:null},{label:"Project Name",value:"projectName"},{label:"Project Manager",value:"projectManager"},{label:"Team Leader",value:"teamLeader"}])}setSearchCategoryMember(){this.state.$searchOptionsEmployee.set([{label:"Semua",value:null},{label:"EmployeeId",value:"employeeId"},{label:"Name",value:"name"}])}onClickSearchProject(){let t=new E;this.$searchForm()?.value?.category==="projectName"?t.projectName=this.$searchForm().value.searchText:this.$searchForm()?.value?.category==="projectManager"?t.projectManager=this.$searchForm().value.searchText:this.$searchForm()?.value?.category==="teamLeader"&&(t.teamLeader=this.$searchForm().value.searchText),this.populateListProject(t)}onClickSearchMember(){let t=new E;this.$searchForm()?.value?.category==="employeeId"?t.employeeId=this.$searchForm().value.searchText:this.$searchForm()?.value?.category==="name"&&(t.employeeName=this.$searchForm().value.searchText),this.$searchForm()?.value?.startDate&&(t.startDate=this.$searchForm()?.value?.startDate),this.$searchForm()?.value?.endDate&&(t.endDate=this.$searchForm()?.value?.endDate),this.populateListMember(t)}onClickResetSearch(){this.$searchForm().reset(),this.state.$formMode()==="projectList"?this.populateListProject():this.populateListMember()}onClickActionAssessment(t){this.state.$formMode.set("memberList"),this.state.$selectedData.set(t),this.populateListMember()}onClickActionSend(t){this.ref=this.dialogService.open(re,{modal:!0}),this.ref.onClose.subscribe(e=>{})}doSend(t){let e=new ne;e.mappingProjectId=this.state.$selectedData()?.id,e.targetId=t,this.sendProjectAssessmentsService.send(e).subscribe(i=>{i.status?this.messageService.add({severity:"success",summary:"Berhasil",detail:"Berhasil Terkirim"}):this.messageService.add({severity:"error",summary:"Error",detail:i.message})},i=>{this.state.$dataLoading.set(!1),console.error("Error fetching project dataList:",i)})}backToHome(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||o)(j(ge),j(ie),j(ue),j(ae),j(Ce),j(fe))};static \u0275prov=O({token:o,factory:o.\u0275fac})};var Fe=(o,t)=>t.field,Ee=()=>({"min-width":"50rem"}),Ne=()=>[5,10,20];function Ve(o,t){o&1&&(n(0,"tr")(1,"td",19)(2,"div"),l(3,"Loading data..."),r()()())}function Oe(o,t){if(o&1&&(n(0,"th",21),l(1),r()),o&2){let e=t.$implicit;a(),z(" ",e.header," ")}}function Be(o,t){if(o&1&&(n(0,"tr"),S(1,Oe,2,1,"th",20),n(2,"th"),l(3," Action "),r()()),o&2){let e=t.$implicit;a(),c("ngForOf",e)}}function Ge(o,t){if(o&1&&(n(0,"td",21),l(1),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(i[e.field])}}function We(o,t){if(o&1&&(n(0,"td",21),l(1),U(2,"date"),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(H(2,1,i[e.field],"dd/MM/yyyy"))}}function ze(o,t){if(o&1&&(n(0,"td",21),l(1),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(i[e.field])}}function Ue(o,t){if(o&1&&S(0,Ge,2,1,"td",21)(1,We,3,4,"td",21)(2,ze,2,1,"td",21),o&2){let e=t.$implicit;$(e.format==="center"?0:e.format==="date"?1:2)}}function He(o,t){if(o&1){let e=w();n(0,"tr",22),B(1,Ue,3,1,null,null,Fe),n(3,"td",23)(4,"p-button",24),f("onClick",function(){let s=_(e).$implicit,u=m();return h(u.sendProjectAssessmentStore.onClickActionSend(s))}),r()()()}if(o&2){let e=t.$implicit,i=t.columns;c("pSelectableRow",e),a(),G(i)}}var se=class o{sendProjectAssessmentStore=g(b);visibleViewLookup=!1;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-send-project-assessment-member-list"]],standalone:!0,features:[P],decls:31,vars:14,consts:[["header",""],["body",""],["header","Send To Member"],[1,"grid","grid-cols-12","gap-2",3,"formGroup"],[1,"col-span-3"],["formControlName","category","placeholder","Search By",1,"w-full",3,"options"],[1,"col-span-9","md:col-span-9"],["pInputText","","formControlName","searchText","name","search"],["label","Search","icon","pi pi-search",3,"onClick"],["label","Reset","icon","pi pi-refresh","severity","info",3,"onClick"],[1,"col-span-1","content-center"],[1,"break-words"],["formControlName","startDate","appendTo","body"],["formControlName","endDate","appendTo","body"],["stripedRows","","showGridlines","",3,"onLazyLoad","value","tableStyle","columns","loading","lazy","paginator","rows","rowsPerPageOptions","paginatorDropdownAppendTo","totalRecords"],["pTemplate","loadingbody"],[1,"mt-4"],[1,"flex","justify-end"],["label","Back","icon","pi pi-sign-out","severity","danger",3,"click"],["colspan","11",1,"text-center"],["class","!text-center",4,"ngFor","ngForOf"],[1,"!text-center"],[3,"pSelectableRow"],[1,"justify-center"],["label","Send","severity","contrast",3,"onClick"]],template:function(e,i){if(e&1){let s=w();n(0,"p-panel",2)(1,"div",3)(2,"div",4),d(3,"p-select",5),r(),n(4,"p-inputgroup",6),d(5,"input",7),n(6,"p-inputgroup-addon")(7,"p-button",8),f("onClick",function(){return _(s),h(i.sendProjectAssessmentStore.onClickSearchMember())}),r()(),n(8,"p-inputgroup-addon")(9,"p-button",9),f("onClick",function(){return _(s),h(i.sendProjectAssessmentStore.onClickResetSearch())}),r()()(),n(10,"div",10)(11,"p",11),l(12,"Start Date"),r()(),n(13,"div",4),d(14,"p-datepicker",12),r(),n(15,"div",10)(16,"p",11),l(17,"End Date"),r()(),n(18,"div",4),d(19,"p-datepicker",13),r()(),d(20,"br"),n(21,"div")(22,"p-table",14),f("onLazyLoad",function(V){return _(s),h(i.sendProjectAssessmentStore.onLazyLoadMember(V))}),S(23,Ve,4,0,"ng-template",15)(24,Be,4,1,"ng-template",null,0,D)(26,He,5,1,"ng-template",null,1,D),r()(),n(28,"div",16)(29,"div",17)(30,"p-button",18),f("click",function(){return _(s),h(i.sendProjectAssessmentStore.backToHome())}),r()()()()}if(e&2){let s=W(27);a(),c("formGroup",i.sendProjectAssessmentStore.$searchForm()),a(2),c("options",i.sendProjectAssessmentStore.$optionsCategoryEmployeeList()),a(19),c("value",i.sendProjectAssessmentStore.$dataListMember())("tableStyle",M(12,Ee))("columns",i.sendProjectAssessmentStore.$colsMember())("loading",i.sendProjectAssessmentStore.$dataLoading())("lazy",!0)("paginator",!0)("rows",5)("rowsPerPageOptions",M(13,Ne))("paginatorDropdownAppendTo",s)("totalRecords",i.sendProjectAssessmentStore.$totalRowCount())}},dependencies:[v,x,K,Q,A,I,X,F,T,Y,Z,q,ee,te,be,R,k,J]})};var qe=(o,t)=>t.field,Je=()=>({"min-width":"50rem"}),Ke=()=>[5,10,20];function Qe(o,t){o&1&&(n(0,"tr")(1,"td",12)(2,"div"),l(3,"Loading data..."),r()()())}function Xe(o,t){if(o&1&&(n(0,"th",14),l(1),r()),o&2){let e=t.$implicit;a(),z(" ",e.header," ")}}function Ye(o,t){if(o&1&&(n(0,"tr"),S(1,Xe,2,1,"th",13),n(2,"th"),l(3," Action "),r()()),o&2){let e=t.$implicit;a(),c("ngForOf",e)}}function Ze(o,t){if(o&1&&(n(0,"td",18),l(1),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(i[e.field])}}function et(o,t){if(o&1&&(n(0,"td"),l(1),U(2,"date"),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(H(2,1,i[e.field],"dd/MM/yyyy"))}}function tt(o,t){if(o&1&&(n(0,"td"),l(1),r()),o&2){let e=m().$implicit,i=m().$implicit;a(),y(i[e.field])}}function ot(o,t){if(o&1&&S(0,Ze,2,1,"td",18)(1,et,3,4,"td")(2,tt,2,1,"td"),o&2){let e=t.$implicit;$(e.format==="center"?0:e.format==="date"?1:2)}}function it(o,t){if(o&1){let e=w();n(0,"tr",15),B(1,ot,3,1,null,null,qe),n(3,"td",16)(4,"p-button",17),f("onClick",function(){let s=_(e).$implicit,u=m();return h(u.sendProjectAssessmentStore.onClickActionAssessment(s))}),r()()()}if(o&2){let e=t.$implicit,i=t.columns;c("pSelectableRow",e),a(),G(i)}}var le=class o{sendProjectAssessmentStore=g(b);visibleViewLookup=!1;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-send-project-assessment-project-list"]],standalone:!0,features:[P],decls:17,vars:14,consts:[["header",""],["body",""],["header","Send Project Assessment"],[1,"grid","grid-cols-12","grid-flow-rows","gap-2","w-full",3,"formGroup"],[1,"col-span-3"],["formControlName","category","placeholder","Search By",1,"w-full",3,"options"],[1,"col-span-9","md:col-span-9"],["pInputText","","formControlName","searchText","name","search"],["label","Search","icon","pi pi-search",3,"onClick"],["label","Reset","icon","pi pi-refresh","severity","info",3,"onClick"],["stripedRows","","showGridlines","",3,"onLazyLoad","value","tableStyle","columns","loading","lazy","paginator","rows","rowsPerPageOptions","paginatorDropdownAppendTo","totalRecords"],["pTemplate","loadingbody"],["colspan","7",1,"text-center"],["class","!text-center",4,"ngFor","ngForOf"],[1,"!text-center"],[3,"pSelectableRow"],[1,"justify-center"],["label","Assessment","severity","contrast",3,"onClick"],[2,"text-align","center"]],template:function(e,i){if(e&1){let s=w();n(0,"p-panel",2)(1,"div",3)(2,"div",4),d(3,"p-select",5),r(),n(4,"p-inputgroup",6),d(5,"input",7),n(6,"p-inputgroup-addon")(7,"p-button",8),f("onClick",function(){return _(s),h(i.sendProjectAssessmentStore.onClickSearchProject())}),r()(),n(8,"p-inputgroup-addon")(9,"p-button",9),f("onClick",function(){return _(s),h(i.sendProjectAssessmentStore.onClickResetSearch())}),r()()()(),d(10,"br"),n(11,"p-table",10),f("onLazyLoad",function(V){return _(s),h(i.sendProjectAssessmentStore.onLazyLoadProject(V))}),S(12,Qe,4,0,"ng-template",11)(13,Ye,4,1,"ng-template",null,0,D)(15,it,5,1,"ng-template",null,1,D),r()()}if(e&2){let s=W(16);a(),c("formGroup",i.sendProjectAssessmentStore.$searchForm()),a(2),c("options",i.sendProjectAssessmentStore.$optionsCategory()),a(8),c("value",i.sendProjectAssessmentStore.$dataListProject())("tableStyle",M(12,Je))("columns",i.sendProjectAssessmentStore.$colsProject())("loading",i.sendProjectAssessmentStore.$dataLoading())("lazy",!0)("paginator",!0)("rows",5)("rowsPerPageOptions",M(13,Ke))("paginatorDropdownAppendTo",s)("totalRecords",i.sendProjectAssessmentStore.$totalRowCount())}},dependencies:[v,x,K,Q,A,I,X,F,T,Y,Z,q,ee,te,R,k,J]})};function nt(o,t){o&1&&d(0,"app-send-project-assessment-project-list")}function rt(o,t){o&1&&d(0,"app-send-project-assessment-member-list")}var Me=class o{sendProjectAssessmentStore=g(b);constructor(){}ngOnInit(){}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-employee"]],standalone:!0,features:[ce([b,ie,oe]),P],decls:4,vars:1,consts:[["header","Send Project Assessment"],[1,"mt-6"]],template:function(e,i){e&1&&(n(0,"p-panel",0)(1,"div",1),S(2,nt,1,0,"app-send-project-assessment-project-list")(3,rt,1,0,"app-send-project-assessment-member-list"),r()()),e&2&&(a(2),$(i.sendProjectAssessmentStore.$formMode()==="projectList"?2:3))},dependencies:[v,x,le,se]})};export{Me as SendProjectAssessmentsComponent};
